var ye=Object.defineProperty;var te=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable;var ae=(e,n,r)=>n in e?ye(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,oe=(e,n)=>{for(var r in n||(n={}))he.call(n,r)&&ae(e,r,n[r]);if(te)for(var r of te(n))we.call(n,r)&&ae(e,r,n[r]);return e};import{u as D,g as Re,o as $e,w as H,_ as ce,a as pe,r as f,b as ve,c as fe,d as Y,e as me,f as ne,h as M,m as K,i as ke,j as ie,k as De,l as ge,n as S,p as L,q as O,s as a,t as J,v as N,x as E,y as T,z as C,A as se,F as q,B as le,C as Q,D as Pe,E as re,G as de,H as Ee,I as Se,J as Le,K as Ae,L as Ie,M as Ve,N as Ce}from"./index.79c4e3e8.js";import{a as U}from"./axios.ab682c6b.js";import{L as ee}from"./LoadingSpinner.24251d8e.js";/* empty css                                                                   */var X={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.generateRut=e.validateRutList=e.validateRut=e.calculateRutVerifier=e.formatRut=e.RutFormat=e.deconstructRut=e.getRutVerifier=e.getRutDigits=e.cleanRut=e.isSuspiciousRut=e.isRutLike=void 0;const n=()=>/^(\d{0,2})\.?(\d{3})\.?(\d{3})-?(\d|k)$/gi,r=()=>/^(\d)\1?\.?(\1{3})\.?(\1{3})-?(\d|k)?$/gi,u=t=>n().test(t);e.isRutLike=u;const P=t=>r().test(t);e.isSuspiciousRut=P;const _=t=>(0,e.isRutLike)(t)?t.replace(/[^0-9k]/gi,""):"";e.cleanRut=_;const $=t=>(0,e.cleanRut)(t).slice(0,-1);e.getRutDigits=$;const w=t=>(0,e.cleanRut)(t).slice(-1);e.getRutVerifier=w;const R=t=>({digits:(0,e.getRutDigits)(t),verifier:(0,e.getRutVerifier)(t)});e.deconstructRut=R;var m;(function(t){t[t.DOTS=0]="DOTS",t[t.DASH=1]="DASH",t[t.DOTS_DASH=2]="DOTS_DASH"})(m=e.RutFormat||(e.RutFormat={}));const y=(t,l=m.DASH)=>{if(t==null)return"";if(typeof t!="string")throw new TypeError("RUT needs to be a string or undefined");if(!(0,e.isRutLike)(t))return t;switch(l){case m.DOTS:return t.replace(n(),(...s)=>`${s[1]?`${s[1]}.`:""}${s[2]}.${s[3]}${s[4]}`);case m.DASH:return t.replace(n(),"$1$2$3-$4");case m.DOTS_DASH:return t.replace(n(),(...s)=>`${s[1]?`${s[1]}.`:""}${s[2]}.${s[3]}-${s[4]}`);default:return t.replace(n(),"$1$2$3$4")}};e.formatRut=y;const g=t=>{let l=0,s=2,A=t.length;for(;A--;)l=l+parseInt(t.charAt(A))*s,s%7===0?s=2:s++;const I=l%11;return I===0?"0":I===1?"k":`${11-I}`};e.calculateRutVerifier=g;const i=(t,l=!0)=>!(0,e.isRutLike)(t)||l&&(0,e.isSuspiciousRut)(t)?!1:(0,e.getRutVerifier)(t).toLowerCase()===(0,e.calculateRutVerifier)((0,e.getRutDigits)(t));e.validateRut=i;const c=(t,l=!0)=>{const s=new Map;for(const A of t)s.set(A,(0,e.validateRut)(A,l));return s};e.validateRutList=c;const h=()=>{const t=Math.floor(10000003+Math.random()*9e7).toString(),l=(0,e.calculateRutVerifier)(t);return(0,e.formatRut)(t+l)};e.generateRut=h})(X);function Oe(e){return Re()?($e(e),!0):!1}function be(e){return typeof e=="function"?e():D(e)}const B=typeof window!="undefined"&&typeof document!="undefined";typeof WorkerGlobalScope!="undefined"&&globalThis instanceof WorkerGlobalScope;const Me=Object.prototype.toString,Te=e=>Me.call(e)==="[object Object]",G=()=>{},Ne=Ue();function Ue(){var e,n;return B&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((n=window==null?void 0:window.navigator)==null?void 0:n.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function j(e){var n;const r=be(e);return(n=r==null?void 0:r.$el)!=null?n:r}const _e=B?window:void 0;B&&window.document;B&&window.navigator;B&&window.location;function Z(...e){let n,r,u,P;if(typeof e[0]=="string"||Array.isArray(e[0])?([r,u,P]=e,n=_e):[n,r,u,P]=e,!n)return G;Array.isArray(r)||(r=[r]),Array.isArray(u)||(u=[u]);const _=[],$=()=>{_.forEach(y=>y()),_.length=0},w=(y,g,i,c)=>(y.addEventListener(g,i,c),()=>y.removeEventListener(g,i,c)),R=H(()=>[j(n),be(P)],([y,g])=>{if($(),!y)return;const i=Te(g)?oe({},g):g;_.push(...r.flatMap(c=>u.map(h=>w(y,c,h,i))))},{immediate:!0,flush:"post"}),m=()=>{R(),$()};return Oe(m),m}let ue=!1;function je(e,n,r={}){const{window:u=_e,ignore:P=[],capture:_=!0,detectIframe:$=!1}=r;if(!u)return G;Ne&&!ue&&(ue=!0,Array.from(u.document.body.children).forEach(i=>i.addEventListener("click",G)),u.document.documentElement.addEventListener("click",G));let w=!0;const R=i=>P.some(c=>{if(typeof c=="string")return Array.from(u.document.querySelectorAll(c)).some(h=>h===i.target||i.composedPath().includes(h));{const h=j(c);return h&&(i.target===h||i.composedPath().includes(h))}}),y=[Z(u,"click",i=>{const c=j(e);if(!(!c||c===i.target||i.composedPath().includes(c))){if(i.detail===0&&(w=!R(i)),!w){w=!0;return}n(i)}},{passive:!0,capture:_}),Z(u,"pointerdown",i=>{const c=j(e);w=!R(i)&&!!(c&&!i.composedPath().includes(c))},{passive:!0}),$&&Z(u,"blur",i=>{setTimeout(()=>{var c;const h=j(e);((c=u.document.activeElement)==null?void 0:c.tagName)==="IFRAME"&&!(h!=null&&h.contains(u.document.activeElement))&&n(i)},0)})].filter(Boolean);return()=>y.forEach(i=>i())}const He={key:0,class:"modal-mask"},Be={class:"modal-wrapper"},ze={class:"modal-header"},xe={class:"modal-body"},Ge={class:"form-group"},qe=["for"],We=["id","value"],Fe={class:"form-group"},Ke={class:"form-group"},Ze={class:"form-group"},Je={class:"form-group"},Xe={class:"form-group"},Ye=["disabled"],Qe=["value","disabled"],et={class:"form-group"},tt=["disabled"],at=["value"],ot={__name:"ModalDatosPacientes",props:{isOpen:Boolean,rut:String},emits:["modal-close","submit-data"],setup(e,{emit:n}){const r=pe(),u=f(),P=ve(),_=fe(),$=f(!1),w=Y(),R=f("RUT"),m=f(0),y=f({}),g=f({}),i="https://apirest.agendafree.cl/api/",c="https://apirestnatalymorales.agendafree.cl/api/",h=()=>({headers:{"x-token":sessionStorage.getItem("token")}}),t=f(!1),l=async()=>{if(!await k.value.$validate()){console.log("Formulario inv\xE1lido");return}console.log("Formulario v\xE1lido",d),z()},s=e,A=n,I=f(null);je(I,()=>A("modal-close"));const d=me({rut:s.rut,nombre:null,email:null,fono:null,nacionalidad:0,prevision_id:0}),W=ne(()=>_.sharedData===0?1:0);H(W,b=>{d.nacionalidad=b});const F=ne(()=>({nombre:{required:M,minLength:K(2)},apellido:{required:M,minLength:K(2)},email:{required:M,email:ke},fono:{required:M,minLength:K(8)},nacionalidad:{required:M,notZero:ie.withMessage("La nacionalidad no puede ser 0",b=>b!==0)},prevision_id:{required:M,notZero:ie.withMessage("La nacionalidad no puede ser 0",b=>b!==0)}})),k=De(F,d);H(()=>_.sharedData,b=>{b==1?(R.value="DNI",d.prevision=3,m.value=1):(R.value="RUT",d.prevision=0,m.value=0)}),H(()=>s.isOpen,b=>{console.log("El valor de isOpen ha cambiado:",b),b?(console.log("El modal se ha abierto"),x(h())):console.log("El modal se ha cerrado")});const z=()=>{const b=f({}),o=f({});_.sharedData==0&&(b.value={nombre:d.nombre,apellido:d.apellido,rut:s.rut,email:d.email,fono:d.fono,nacionalidad_id:1,prevision_id:d.prevision_id}),_.sharedData==1&&(o.value={nombre:d.nombre,apellido:d.apellido,rut:s.rut,email:d.email,fono:d.fono,nacionalidad_id:d.nacionalidad,prevision_id:d.prevision_id},console.log("Nuevo paciente extranjero: ",o)),console.log(i+"persona",_.sharedData==0?b.value:o.value),console.log("token desde ModalDatosPacientes",h()),t.value=!0,U.post(i+"persona",_.sharedData==0?b.value:o.value,h()).then(V=>{V?(u.value=V.data,$.value=!$.value,$.value?(P.setPaciente(V.data.paciente.paciente),r.setPersona(V.data),console.log("Paciente en store: ",P.getPaciente()),t.value=!1,w.push({name:"modulo-reserva"})):w.push({name:"agenda"})):($.value=!0,t.value=!1)})},x=async b=>{try{const o=await U.get(`${c}prevision`,b);y.value=o.data.previsiones.filter(v=>v.estado_id===3);const V=await U.get(`${i}nacionalidad`,b);g.value=V.data.nacionalidades.filter(v=>v.estado_id===1)}catch(o){console.error("Error al obtener datos de previsi\xF3n o nacionalidad:",o)}},p=f({particles:{number:{value:80,density:{enable:!0,value_area:800}},color:{value:"#16A085"},shape:{type:"circle",stroke:{width:0,color:"#000000"},polygon:{nb_sides:5}},opacity:{value:.5,random:!1,anim:{enable:!1,speed:1,opacity_min:.1,sync:!1}},size:{value:3,random:!0,anim:{enable:!1,speed:40,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:150,color:"#ffffff",opacity:.4,width:1},move:{enable:!0,speed:6,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"repulse"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:400,line_linked:{opacity:1}},bubble:{distance:400,size:40,duration:2,opacity:8,speed:3},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}}},retina_detect:!0});return(b,o)=>{const V=ge("vue-particles");return s.isOpen?(S(),L("div",He,[O(ee,{isLoading:t.value},null,8,["isLoading"]),a("div",Be,[a("div",{class:"modal-container",ref_key:"target",ref:I},[a("div",ze,[o[8]||(o[8]=a("h4",{class:"modal-title"},"Bienvenid@",-1)),a("button",{type:"button",class:"close-btn",onClick:o[0]||(o[0]=v=>A("modal-close"))},o[7]||(o[7]=[a("i",{class:"fa fa-fw fa-times"},null,-1)]))]),a("div",xe,[O(V,{id:"tsparticles",options:p.value},null,8,["options"]),o[18]||(o[18]=a("p",{class:"modal-description"}," Para solicitar hora de atenci\xF3n por favor ingrese sus datos y presione continuar ",-1)),a("div",null,[a("form",{onSubmit:J(l,["prevent"])},[a("div",Ge,[a("label",{for:R.value,class:"rainbow-text"},N(R.value)+":",9,qe),a("input",{id:R.value,type:"text",value:s.rut,disabled:""},null,8,We)]),a("div",Fe,[o[9]||(o[9]=a("label",{for:"nombre",class:"rainbow-text"},"Nombre: ",-1)),E(a("input",{"onUpdate:modelValue":o[1]||(o[1]=v=>d.nombre=v),id:"nombre",type:"text",placeholder:"Nombre",class:C({"is-invalid":D(k).nombre.$invalid&&D(k).nombre.$dirty})},null,2),[[T,d.nombre]])]),a("div",Ke,[o[10]||(o[10]=a("label",{class:"rainbow-text",for:"apellido"},"Apellido: ",-1)),E(a("input",{"onUpdate:modelValue":o[2]||(o[2]=v=>d.apellido=v),id:"apellido",type:"text",placeholder:"Apellido",class:C({"is-invalid":D(k).apellido.$invalid&&D(k).apellido.$dirty})},null,2),[[T,d.apellido]])]),a("div",Ze,[o[11]||(o[11]=a("label",{class:"rainbow-text",for:"email"},"Email: ",-1)),E(a("input",{"onUpdate:modelValue":o[3]||(o[3]=v=>d.email=v),id:"email",type:"email",placeholder:"Email",class:C({"is-invalid":D(k).email.$invalid&&D(k).email.$dirty})},null,2),[[T,d.email]])]),a("div",Je,[o[12]||(o[12]=a("label",{class:"rainbow-text",for:"telefono"},"Tel\xE9fono: ",-1)),E(a("input",{"onUpdate:modelValue":o[4]||(o[4]=v=>d.fono=v),id:"telefono",type:"text",placeholder:"+56935281541",class:C({"is-invalid":D(k).fono.$invalid&&D(k).fono.$dirty})},null,2),[[T,d.fono]])]),a("div",Xe,[o[14]||(o[14]=a("label",{for:"nacionalidad",class:"rainbow-text"},"Nacionalidad: ",-1)),E(a("select",{"onUpdate:modelValue":o[5]||(o[5]=v=>d.nacionalidad=v),disabled:D(_).sharedData==0,id:"nacionalidad",class:C({"is-invalid":D(k).nacionalidad.$invalid&&D(k).nacionalidad.$dirty})},[o[13]||(o[13]=a("option",{value:"0",disabled:""},"Nacionalidades...",-1)),(S(!0),L(q,null,le(g.value,v=>(S(),L("option",{key:v.id,value:v.id,disabled:D(_).sharedData==1&&v.id==1},N(v.nombre),9,Qe))),128))],10,Ye),[[se,d.nacionalidad]])]),a("div",et,[o[16]||(o[16]=a("label",{for:"prevision",class:"rainbow-text"},"Previsi\xF3n: ",-1)),E(a("select",{"onUpdate:modelValue":o[6]||(o[6]=v=>d.prevision_id=v),id:"prevision",disabled:D(_).sharedData==1,class:C({"is-invalid":D(k).prevision_id.$invalid&&D(k).prevision_id.$dirty})},[o[15]||(o[15]=a("option",{value:"0",disabled:"",selected:""},"Previsiones...",-1)),(S(!0),L(q,null,le(y.value,v=>(S(),L("option",{value:v.id},N(v.nombre),9,at))),256))],10,tt),[[se,d.prevision_id]])]),o[17]||(o[17]=a("div",{class:"text-end"},[a("button",{type:"submit",class:"submit-btn"}," Continuar ")],-1))],32)])])],512)])])):Q("",!0)}}};var nt=ce(ot,[["__scopeId","data-v-c7bbdbc8"]]);const it={class:"row mt-3 justify-content-center"},st={class:"col-12 col-md-10 col-lg-8"},lt={class:"input-rut"},rt=["placeholder"],dt=["disabled"],ut={class:"input-rut"},ct=["placeholder"],pt={class:"mt-2 text-center"},vt={__name:"inputRut",setup(e){const n=f(!1),r=pe(),u=ve(),P=fe(),_="https://apirest.agendafree.cl/api/",$=Y(),w=f(""),R=f(!1),m=f(""),y=f(!1),g=f(0),i=f(),c=()=>({headers:{"x-token":sessionStorage.getItem("token")}}),h=()=>{P.updateData(g.value)},t=()=>{l(),h()},l=()=>{n.value=!0,console.log("data")},s=()=>{n.value=!1},A=()=>{s(),console.log("Hola desde cerrar modal")},I=()=>{R.value=X.validateRut(w.value),m.value=X.formatRut(w.value)},d=()=>{w.value=m.value},W=()=>{g.value=1,m.value=""},F=()=>{g.value=0,w.value=""},k=[{tipo:"RUT",ejemplo:"Rut Ej: 17463223-K"},{tipo:"DNI",ejemplo:"Ingrese su DNI"}],z=async x=>{y.value=!0,console.log("token desde Input",c()),U.get(`${_}persona/rut/${x}`,c()).then(p=>{p&&(i.value=p.data.paciente,console.log(i.value),u.setPaciente(i.value),r.setPersona(p.data),console.log("store paciente: ",u.getPaciente()),$.push({name:"modulo-reserva"}))}).catch(p=>{console.log("Error: ",p),t()}).finally(()=>{y.value=!1})};return(x,p)=>{const b=Pe("click-ripple");return S(),L(q,null,[O(ee,{isLoading:y.value},null,8,["isLoading"]),a("div",it,[a("div",st,[E(a("div",lt,[E(a("input",{type:"text",class:C(["form-control",{"text-info":!R.value}]),placeholder:k[0].ejemplo,onInput:I,onChange:d,"onUpdate:modelValue":p[0]||(p[0]=o=>w.value=o)},null,42,rt),[[T,w.value]]),E((S(),L("button",{type:"button",class:"btn btn-primary",onClick:p[1]||(p[1]=o=>z(m.value)),disabled:!R.value},p[6]||(p[6]=[de(" CONTINUAR "),a("i",{class:"fa fa-fw fa-arrow-right"},null,-1)]),8,dt)),[[b]])],512),[[re,g.value==0]]),E(a("div",ut,[E(a("input",{type:"text",class:"form-control",placeholder:k[1].ejemplo,"onUpdate:modelValue":p[2]||(p[2]=o=>m.value=o)},null,8,ct),[[T,m.value]]),E((S(),L("button",{type:"button",class:"btn btn-primary",onClick:p[3]||(p[3]=o=>z(m.value))},p[7]||(p[7]=[de(" CONTINUAR "),a("i",{class:"fa fa-fw fa-arrow-right"},null,-1)]))),[[b]])],512),[[re,g.value==1]]),a("div",pt,[g.value==0?(S(),L("a",{key:0,href:"#",onClick:p[4]||(p[4]=J(o=>W(),["prevent"])),class:"toggle-input"},"Ingresar con "+N(k[1].tipo),1)):g.value==1?(S(),L("a",{key:1,href:"#",onClick:p[5]||(p[5]=J(o=>F(),["prevent"])),class:"toggle-input"},"Ingresar con "+N(k[0].tipo),1)):Q("",!0)])])]),O(nt,{isOpen:n.value,rut:m.value,onModalClose:s,onSubmitData:A},null,8,["isOpen","rut"])],64)}}};var ft=ce(vt,[["__scopeId","data-v-1bf29180"]]);const mt={key:0,class:"spinner-overlay"},gt={class:"hero d-flex align-items-center justify-content-center"},bt={class:"hero-content","transition-style":"in:circle:hesitate"},_t={class:"content content-full text-center"},yt={class:"fw-light mb-5"},ht={class:"row justify-content-center"},wt={class:"col-12 col-xl-10"},Rt={class:"bg-card p-5 rounded shadow-lg"},$t={class:"input-container"},Lt={__name:"LandingEspecialistaView",setup(e){const n=me({username:"visita",password:"2843bc16"}),r=f(null),u=f(!0),P=Ee(),_=Se(),$=f({id:"",uid:"",username:"",estado_id:"",nombre:"",apellido:""});f(null);const w=Le(),R=Y(),m=w.params.uid,y=f([]),g="https://apirest.agendafree.cl/api/",i=async()=>{var t;console.log("token desde getEspecialista",r.value);try{const l=await U.get(`${g}users/uid/${m}`,r.value);if(!l||!l.data)throw new Error("No se recibieron datos");const s=(t=l.data.personas[0])==null?void 0:t.profesionales[0];if(!s||!s.habilitado||!s.ruta_api)throw new Error("Profesional no v\xE1lido o no habilitado");_.setUrl(s.ruta_api),y.value=l.data}catch(l){console.error("Error al obtener datos del especialista:",l),R.push({path:"/error"})}},c=async()=>{try{const t=await U.post(`${g}auth/login`,n);t?(sessionStorage.setItem("token",t.data.token),r.value={headers:{"x-token":t.data.token}},console.log("Usuario autenticado:",t.data.token)):console.error("Error al autenticar al usuario:",t.data)}catch(t){console.error("Error al autenticar al usuario:",t),R.push({path:"/error"})}};Ae(async()=>{await c(),await i()}),Ie(()=>{u.value=!1}),H(y,t=>{const l=t.personas[0];$.value=l,P.setEspecialista($.value),console.log("store especialista: ",P.especialista)});const h=f({background:{color:{value:"#ffffff"}},fpsLimit:120,interactivity:{events:{onClick:{enable:!0,mode:"push"},onHover:{enable:!0,mode:"repulse"}},modes:{bubble:{distance:400,duration:2,opacity:.8,size:40},push:{quantity:4},repulse:{distance:200,duration:.4}}},particles:{color:{value:"#16A085"},links:{color:"#ffff",distance:150,enable:!0,opacity:.5,width:1},move:{direction:"none",enable:!0,outModes:"bounce",random:!1,speed:6,straight:!1},number:{density:{enable:!0},value:80},opacity:{value:.5},shape:{type:"circle"},size:{value:{min:1,max:5}}},detectRetina:!0});return Ve(()=>{setTimeout(()=>{document.querySelector(".hero-content").style.animationPlayState="running"},100)}),(t,l)=>{const s=ge("vue-particles");return S(),L(q,null,[O(ee,{isLoading:u.value},null,8,["isLoading"]),u.value?(S(),L("div",mt,l[0]||(l[0]=[Ce('<div class="loader"><div class="orbe" style="--index:0;"></div><div class="orbe" style="--index:1;"></div><div class="orbe" style="--index:2;"></div><div class="orbe" style="--index:3;"></div><div class="orbe" style="--index:4;"></div></div>',1)]))):Q("",!0),a("div",gt,[l[4]||(l[4]=a("div",{class:"animated-background"},[a("div",{class:"shape shape-1"}),a("div",{class:"shape shape-2"}),a("div",{class:"shape shape-3"})],-1)),a("div",bt,[a("div",_t,[l[2]||(l[2]=a("i",{class:"fa fa-4x fa-stethoscope text-primary mb-5"},null,-1)),l[3]||(l[3]=a("h1",{class:"fw-bold mb-4"},"Sistema de Reservas Online",-1)),a("h2",yt,"Dr. "+N($.value.nombre+" "+$.value.apellido),1),a("div",ht,[a("div",wt,[a("div",Rt,[l[1]||(l[1]=a("p",{class:"fs-4 fw-medium text-dark mb-4"}," Para solicitar una hora de atenci\xF3n, ingrese su RUT y presione continuar. ",-1)),a("div",$t,[O(ft)])])])])])])]),O(s,{id:"tsparticles",options:h.value,onParticlesLoaded:t.particlesLoaded},null,8,["options","onParticlesLoaded"])],64)}}};export{Lt as default};
