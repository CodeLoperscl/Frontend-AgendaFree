import{a as E}from"./axios-CdtiCRuU.js";import{r as P,f as b,w as j,V as p,N as O,Y as m,l as h,n as g,t as f,Q as G,W as L,F,A as $,B as T,X as W,q as d,s as z,y as V,T as J,_ as Q,K as X,e as Y,S as U,I as Z,J as M,p as x,u as I,E as ee}from"./index-BA34nXVB.js";var te={show:"Show",entries:"entries",previous:"Previous",next:"Next",showing:"Showing",showingTo:"to",showingOf:"of",showingEntries:"entries"};const H="...";function se(t,s,n){let e;return function(){const c=this,l=arguments;clearTimeout(e),e=setTimeout(function(){e=null,t.apply(c,l)},s)}}function K(t){for(const s in t)return!1;return!0}function ae(t,s){const e=[],c=[];let l;if(e.push(1),t<=1)return e;for(let a=s-2;a<=s+2;a++)a<t&&a>1&&e.push(a);e.push(t);for(let a=0;a<e.length;a++)l&&(e[a]-l===2?c.push(l+1):e[a]-l!==1&&c.push(H)),c.push(e[a]),l=e[a];return c}function ne(t,s={}){const n=[];let e;const c=t.length;return t=t.map(function(l,a){return l[0]==="-"?(n[a]=-1,l=l.substring(1)):n[a]=1,l}),function(l,a){for(e=0;e<c;e++){const v=t[e],y=s[v]?s[v](l.value[v]):l.value[v],w=s[v]?s[v](a.value[v]):a.value[v];if(y>w)return n[e];if(y<w)return-n[e]}return 0}}function oe(t,s){for(const n in s)t=t.filter(function(e){const c=e.value;for(const l in c)if(l===n){if(typeof s[n]=="function")return s[n](c[l]);if(s[n]===""||c[l]===s[n])return!0}return!1});return t}function ie(t,s,n,e){e=String(e).toLowerCase();for(const c in n)if(t.length===0||t.indexOf(c)!==-1){const l=String(n[c]).toLowerCase();for(const a in s)if(a===c&&typeof s[a]=="function"){const v=s[a](l,e,n);if(v===!0)return v}if(l.indexOf(e)>=0)return!0}return!1}var C=(t,s)=>{for(const[n,e]of s)t[n]=e;return t};const le={props:{dsData:{type:Array,default:()=>[]},dsFilterFields:{type:Object,default:()=>({})},dsSortby:{type:Array,default:()=>[]},dsSearchIn:{type:Array,default:()=>[]},dsSearchAs:{type:Object,default:()=>({})},dsSortAs:{type:Object,default:()=>({})}},setup(t){const s=P(1),n=P(""),e=P(10),c=P(te),l=P([]),a=r=>{n.value=r},v=async r=>{const o=k.value;e.value=r,await J();const i=k.value;i.length<o.length&&y(i[i.length-1])},y=r=>{s.value=r},w=b(()=>(t.dsData,n.value,t.dsSortby,t.dsFilterFields,t.dsSearchIn,t.dsSearchAs,t.dsSortAs,Date.now())),B=b(()=>l.value.slice(N.value,R.value)),k=b(()=>ae(A.value,s.value)),S=b(()=>l.value.length),A=b(()=>Math.ceil(S.value/e.value)),N=b(()=>(s.value-1)*e.value),R=b(()=>s.value*e.value);return j(S,(r,o)=>{y(1)}),j(w,(r,o)=>{let i=[];!n.value&&!t.dsSortby.length&&K(t.dsFilterFields)?i=t.dsData.map((_,u)=>u):(i=t.dsData.map((_,u)=>({index:u,value:_})),K(t.dsFilterFields)||(i=oe(i,t.dsFilterFields)),n.value&&(i=i.filter(_=>ie(t.dsSearchIn,t.dsSearchAs,_.value,n.value))),t.dsSortby.length&&i.sort(ne(t.dsSortby,t.dsSortAs)),i=i.map(_=>_.index)),l.value=i},{immediate:!0}),p("dsIndexes",l),p("search",a),p("showEntries",v),p("setActive",y),p("datasetI18n",c),p("dsData",b(()=>t.dsData)),p("dsRows",B),p("dsPages",k),p("dsResultsNumber",S),p("dsPagecount",A),p("dsFrom",N),p("dsTo",R),p("dsPage",s),{dsIndexes:l,dsShowEntries:e,dsResultsNumber:S,dsPage:s,dsPagecount:A,dsFrom:N,dsTo:R,dsRows:B,dsPages:k,search:a,showEntries:v,setActive:y}}};function re(t,s,n,e,c,l){return O(t.$slots,"default",{ds:{dsIndexes:e.dsIndexes,dsShowEntries:e.dsShowEntries,dsResultsNumber:e.dsResultsNumber,dsPage:e.dsPage,dsPagecount:e.dsPagecount,dsFrom:e.dsFrom,dsTo:e.dsTo,dsData:n.dsData,dsRows:e.dsRows,dsPages:e.dsPages,search:e.search,showEntries:e.showEntries,setActive:e.setActive}})}var de=C(le,[["render",re]]);const ce={setup(){const t=m("dsResultsNumber"),s=m("dsFrom"),n=m("dsTo"),e=b(()=>t.value!==0?s.value+1:0),c=b(()=>n.value>=t.value?t.value:n.value);return{datasetI18n:m("datasetI18n"),dsResultsNumber:t,showing:e,showingTo:c}}};function ue(t,s,n,e,c,l){return h(),g("div",null,f(e.datasetI18n.showing)+" "+f(e.showing)+" "+f(e.datasetI18n.showingTo)+" "+f(e.showingTo)+" "+f(e.datasetI18n.showingOf)+" "+f(e.dsResultsNumber)+" "+f(e.datasetI18n.showingEntries),1)}var fe=C(ce,[["render",ue]]);const he={props:{tag:{type:String,default:"div"}},setup(){const t=b(()=>{const s=[];for(let n=m("dsFrom").value;n<m("dsTo").value;n++)s.push(n);return s});return{dsData:m("dsData"),dsRows:m("dsRows"),indexes:t}}};function ve(t,s,n,e,c,l){return h(),G(W(n.tag),null,{default:L(()=>[(h(!0),g(F,null,$(e.dsRows,(a,v)=>O(t.$slots,"default",{row:e.dsData[a],rowIndex:a,index:e.indexes[v]})),256)),e.dsRows.length?T("",!0):O(t.$slots,"noDataFound",{key:0})]),_:3})}var ge=C(he,[["render",ve]]);const _e={setup(){const t=P(H),s=m("dsPage"),n=m("dsPagecount"),e=b(()=>s.value===1),c=b(()=>s.value===n.value||n.value===0);return{datasetI18n:m("datasetI18n"),setActive:m("setActive"),dsPages:m("dsPages"),dsPagecount:n,dsPage:s,morePages:t,disabledPrevious:e,disabledNext:c}}},me={class:"pagination"},be=["tabindex","aria-disabled"],pe=["onClick"],ye={key:1,class:"page-link"},we=["tabindex","aria-disabled"];function xe(t,s,n,e,c,l){return h(),g("ul",me,[d("li",{class:V(["page-item",e.disabledPrevious&&"disabled"])},[d("a",{class:"page-link",href:"#",tabindex:e.disabledPrevious?"-1":null,"aria-disabled":e.disabledPrevious?"true":null,onClick:s[0]||(s[0]=z(a=>e.setActive(e.dsPage!==1&&e.dsPagecount!==0?e.dsPage-1:e.dsPage),["prevent"]))},f(e.datasetI18n.previous),9,be)],2),(h(!0),g(F,null,$(e.dsPages,(a,v)=>(h(),g("li",{key:v,class:V(["page-item",a===e.dsPage&&"active",a===e.morePages&&"disabled"])},[a!==e.morePages?(h(),g("a",{key:0,class:"page-link",href:"#",onClick:z(y=>e.setActive(a),["prevent"])},f(a),9,pe)):(h(),g("span",ye,f(a),1))],2))),128)),d("li",{class:V(["page-item",e.disabledNext&&"disabled"])},[d("a",{class:"page-link",href:"#",tabindex:e.disabledNext?"-1":null,"aria-disabled":e.disabledNext?"true":null,onClick:s[1]||(s[1]=z(a=>e.setActive(e.dsPage!==e.dsPagecount&&e.dsPagecount!==0?e.dsPage+1:e.dsPage),["prevent"]))},f(e.datasetI18n.next),9,we)],2)])}var Pe=C(_e,[["render",xe]]);const ke={props:{dsSearchPlaceholder:{type:String,default:""},wait:{type:Number,default:0}},setup(t){const s=m("search"),n=P(""),e=se(c=>{s(c)},t.wait);return{dsSearch:n,input:e}}},Se=["placeholder","value"];function Ee(t,s,n,e,c,l){return h(),g("input",{type:"text",placeholder:n.dsSearchPlaceholder,class:"form-control",value:e.dsSearch,onInput:s[0]||(s[0]=a=>e.input(a.target.value))},null,40,Se)}var Ie=C(ke,[["render",Ee]]);const Ce={props:{dsShowEntries:{type:Number,default:10},dsShowEntriesLovs:{type:Array,default:()=>[{value:5,text:5},{value:10,text:10},{value:25,text:25},{value:50,text:50},{value:100,text:100}]}},emits:["changed"],setup(t,{emit:s}){const n=m("showEntries"),e=c=>{s("changed",Number(c.target.value)),n(Number(c.target.value))};return n(Number(t.dsShowEntries)),{datasetI18n:m("datasetI18n"),change:e}}},Ae={class:"form-inline"},Ne=["value"],Re=["value"];function De(t,s,n,e,c,l){return h(),g("div",Ae,[d("label",null,f(e.datasetI18n.show),1),d("select",{value:n.dsShowEntries,class:"form-control mr-1 ml-1",onChange:s[0]||(s[0]=(...a)=>e.change&&e.change(...a))},[(h(!0),g(F,null,$(n.dsShowEntriesLovs,a=>(h(),g("option",{key:a.value,value:a.value},f(a.text),9,Re))),128))],40,Ne),d("label",null,f(e.datasetI18n.entries),1)])}var Te=C(Ce,[["render",De]]);const Fe={class:"content"},Be=["data-page-count"],Le={id:"datasetLength",class:"col-md-8 py-2"},Ve={class:"col-md-4 py-2"},$e={class:"row"},ze={class:"col-md-12"},Oe={class:"table-responsive"},je={class:"table table-hover mb-0"},Ke=["onClick"],Me={scope:"row"},He={style:{"min-width":"150px"}},qe={style:{"min-width":"150px"}},Ge={style:{"min-width":"150px"}},We={style:{"min-width":"150px"}},Je={key:0,class:"fs-xs fw-semibold d-inline-block py-1 px-3 rounded-pill bg-success-light text-success"},Qe={key:1,class:"fs-xs fw-semibold d-inline-block py-1 px-3 rounded-pill bg-info-light text-info"},Xe={key:2,class:"fs-xs fw-semibold d-inline-block py-1 px-3 rounded-pill bg-warning-light text-warning"},Ye=["onClick"],Ue=["onClick"],Ze=["onClick"],et=["onClick"],tt={class:"d-flex flex-md-row flex-column justify-content-between align-items-center"},st={__name:"TablaReserva",setup(t){const s=()=>({headers:{"x-token":sessionStorage.getItem("especialista-token")}}),e=X().params.uid,c="https://apirest.agendafree.cl/api/",l=P(""),a=P(),v=async()=>{await E.get(c+"users/uid/"+e,s()).then(r=>{r.data.personas[0].profesionales[0].habilitado==!0&&r.data.personas[0].profesionales[0].ruta_api&&(l.value=r.data.personas[0].profesionales[0].ruta_api,console.log("API_ESPECIALISTA: ",l.value),y(r.data.personas[0].profesionales[0].ruta_api))}).catch(r=>{console.log(r)})},y=async r=>{try{const o=await E.get(`${r}/api/cita/`,s());o&&o.data&&(a.value=o.data.allCitas.filter(i=>i.estados_cita.id!==4&&i.estados_cita.id!==5).map(i=>({id:i.id,nombre_persona:`${i.persona.nombre} ${i.persona.apellido}`,fecha:i.fecha,prevision:i.previsione.nombre,hora:i.horas_disponible.hora,estado:{id:i.estados_cita.id,nombre:i.estados_cita.estado}})).reverse(),console.log("citas filtradas y mas:",a.value))}catch(o){console.error("Error al obtener citas:",o)}},w=Y([{name:"Paciente",field:"paciente",sort:""},{name:"Dia",field:"dia",sort:""},{name:"Hora",field:"hora",sort:""},{name:"Prevision",field:"prevision",sort:""},{name:"Estado",field:"estado",sort:""},{name:"Acciones",field:"",sort:""}]),B=b(()=>w.reduce((r,o)=>(o.sort&&(o.sort==="asc"?r.push(o.field):r.push("-"+o.field)),r),[]));function k(r,o){let i;const _=w[o];r.shiftKey||w.forEach(u=>{u.field!==_.field&&(u.sort="")}),_.sort||(i="asc"),_.sort==="desc"&&(i=r.shiftKey?"":"asc"),_.sort==="asc"&&(i="desc"),_.sort=i}U(()=>{document.querySelectorAll("#datasetLength label").forEach(o=>{o.remove()});let r=document.querySelector("#datasetLength select");r.classList="",r.classList.add("form-select"),r.style.width="80px"});const S=r=>{E.put(`${l.value}api/cita/${r}`,{estado_cita_id:5},s()).then(o=>{o&&(a.value=a.value.filter(i=>i.id!==r))}).catch(o=>{console.error("Error al rechazar la cita:",o)})},A=r=>{E.put(`${l.value}api/cita/${r}`,{estado_cita_id:2},s()).then(o=>{if(o){console.log("Cita actualizada: ",o.data);const i=a.value.find(_=>_.id===r);i&&(i.estado.id=2)}}).catch(o=>{console.error("Error al solicitar abono:",o)})},N=r=>{E.put(`${l.value}api/cita/${r}`,{estado_cita_id:4},s()).then(o=>{o.data&&(console.log("Cita actualizada: ",o.data),a.value=a.value.filter(i=>i.id!==r))}).catch(o=>{console.error("Error al confirmar la cita:",o)})},R=r=>{E.put(`${l.value}api/cita/${r}`,{estado_cita_id:1},s()).then(o=>{if(o.data){const i=a.value.find(_=>_.id===r);i&&(i.estado.id=1)}})};return Z(async()=>{await v()}),(r,o)=>{const i=M("BaseBlock");return h(),g("div",Fe,[x(i,{title:"Solicitudes sin gestionar","content-full":""},{default:L(()=>[x(I(de),{"ds-data":a.value,"ds-sortby":B.value,"ds-search-in":["paciente","dia","hora","prevision","estado"]},{default:L(({ds:_})=>[d("div",{class:"row","data-page-count":_.dsPagecount},[d("div",Le,[x(I(Te),{"ds-show-entries":5})]),d("div",Ve,[x(I(Ie),{"ds-search-placeholder":"Buscar..."})])],8,Be),o[6]||(o[6]=d("hr",null,null,-1)),d("div",$e,[d("div",ze,[d("div",Oe,[d("table",je,[d("thead",null,[d("tr",null,[o[1]||(o[1]=d("th",{scope:"col"},"ID",-1)),(h(!0),g(F,null,$(w,(u,D)=>(h(),g("th",{key:u.field,class:V(["sort",u.sort]),onClick:q=>k(q,D)},[ee(f(u.name)+" ",1),o[0]||(o[0]=d("i",{class:"gg-select float-end"},null,-1))],10,Ke))),128))])]),x(I(ge),{tag:"tbody",class:"fs-sm"},{default:L(({row:u})=>[d("tr",null,[d("th",Me,f(u.id),1),d("td",He,f(u.nombre_persona),1),d("td",null,f(u.fecha),1),d("td",qe,f(u.hora),1),d("td",Ge,f(u.prevision),1),d("td",We,[u.estado.id===1?(h(),g("span",Je,f("Solicitado"))):T("",!0),u.estado.id===2?(h(),g("span",Qe,f("Solicitud abono"))):T("",!0),u.estado.id===3?(h(),g("span",Xe,f("Pendiente revision"))):T("",!0)]),d("td",null,[d("button",{type:"button",class:"btn btn-sm btn-alt-success m-1",style:{width:"auto","min-width":"60px"},onClick:D=>N(u.id)},o[2]||(o[2]=[d("span",{class:"d-none d-lg-inline"},"Confirmar",-1),d("i",{class:"fa fa-calendar-check d-lg-none"},null,-1)]),8,Ye),d("button",{type:"button",class:"btn btn-sm btn-alt-danger m-1",style:{width:"auto","min-width":"60px"},onClick:D=>S(u.id)},o[3]||(o[3]=[d("span",{class:"d-none d-lg-inline"},"Rechazar",-1),d("i",{class:"fa fa-times-circle d-lg-none"},null,-1)]),8,Ue),u.estado.id==1?(h(),g("button",{key:0,type:"button",class:"btn btn-sm btn-alt-primary m-1",style:{width:"auto","min-width":"60px"},onClick:D=>A(u.id)},o[4]||(o[4]=[d("span",{class:"d-none d-lg-inline"},"Solicitar abono",-1),d("i",{class:"fa fa-money-check-dollar d-lg-none"},null,-1)]),8,Ze)):u.estado.id==2?(h(),g("button",{key:1,type:"button",class:"btn btn-sm btn-alt-primary m-1",style:{width:"auto","min-width":"60px"},onClick:D=>R(u.id)},o[5]||(o[5]=[d("span",{class:"d-none d-lg-inline"},"Rechazar Abono",-1),d("i",{class:"fa fa-money-check-dollar d-lg-none"},null,-1)]),8,et)):T("",!0)])])]),_:1})])])])]),d("div",tt,[x(I(fe),{class:"py-3 fs-sm"}),x(I(Pe),{class:"flex-wrap py-3 fs-sm"})])]),_:1},8,["ds-data","ds-sortby"])]),_:1})])}}},at=Q(st,[["__scopeId","data-v-1c5c9ccc"]]),it={__name:"ConfirmarHoraView",setup(t){return(s,n)=>{const e=M("BasePageHeading");return h(),g(F,null,[x(e,{title:"Solicitudes pendientes"}),x(at)],64)}}};export{it as default};
